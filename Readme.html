<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Readme</title>
  <style>
    html {
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    svg {
      height: auto;
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<!---

Add some status badges eventually.
[![codecov](https://codecov.io/gh/filipdutescu/modern-cpp-template/branch/master/graph/badge.svg)](https://codecov.io/gh/filipdutescu/modern-cpp-template)
[![GitHub release (latest by date)](https://img.shields.io/github/v/release/filipdutescu/modern-cpp-template)](https://github.com/filipdutescu/modern-cpp-template/releases)

![LogoBootstrap60x90](https://github.com/user-attachments/assets/92fe4271-e308-45e4-9afc-b049fa4c3e0f)

![Bootstrap](docs/src/images/pub/LogoBootstrap60x90.png) 

-->
<h1 align="center">
C++ Bootstrap Project
</h1>
<p align="center">
<img src="https://github.com/user-attachments/assets/92fe4271-e308-45e4-9afc-b049fa4c3e0f" alt="">
</p>
<p align="center">
Provides a pre-canned C++ project layout along with automation,
containerized tools and fill-in-the-blanks documentation.
</p>
<hr />
<h2 id="features">Features</h2>
<ul>
<li>Top level Makefile framework for launching targets</li>
<li>Uses <a href="#containerized-tools">containers</a> for build tools
(compiler, CMake, auto-docs, etc)</li>
<li>CMake used only for C++ compilation/linking</li>
<li><a href="#simultaneous-production-and-debug-trees">Production and
debug</a> trees in same workspace simultaneously</li>
<li><a href="#conan-setup">Setup</a> with <a
href="https://conan.io/">Conan</a> v2.0 C++ libary management</li>
<li>Configured as a consumer of Conan libraries (not a producer)</li>
<li>Also setup for two locally developed internal-only libraries</li>
<li>Automated <a href="#documentation-generation">documentation
generation</a> with deployment to GitHub Pages</li>
<li>Documentation tools - Sphinx, Doxygen, PlantUML</li>
<li>All documentation organized together under a single static
website</li>
<li><a href="https://github.com/doctest/doctest">doctest</a> unit
testing framework</li>
<li><a href="#code-coverage">code coverage</a> using <a
href="https://github.com/linux-test-project/lcov">lcov</a></li>
<li><a href="#static-code-analysis">Static code analysis</a> via <a
href="https://cppcheck.sourceforge.io/manual.html">cppcheck</a></li>
<li>Single <a href="#versioning">“version”</a> file in top level folder
drives all targets</li>
<li>Clean unpolluted <a href="#project-layout">top level folder</a></li>
<li>GitHub Continuous Integration (not implemented yet)</li>
<li>Spell checking on docs, batch or interactive mode</li>
</ul>
<p>See the auto-generated documentation here on <a
href="https://kingsolomon1954.github.io/cpp-bootstrap">Github
Pages</a>.</p>
<p><em>RedFlame</em> is used as the name of the hypothetical application
that is built.</p>
<h2 id="prerequisites">Prerequisites</h2>
<ul>
<li>GNU Makefile</li>
<li>Podman or Docker</li>
<li>Some typical Linux command line utilities</li>
</ul>
<p>Jump ahead to <a href="#getting-started">Getting Started</a> if
you’re so inclined.</p>
<h2 id="folder-layout">Folder Layout</h2>
<p><strong>Top Level View</strong></p>
<pre><code>├── src/
├── docs/
├── tools/
├── etc/
├── _build/
├── Makefile
├── version
└── Readme.md</code></pre>
<p><strong>Two Level View</strong></p>
<pre><code>├── Makefile
├── Readme.md
├── version
├── src/
│  ├── CMakeLists.txt
│  ├── main
│  │  ├── include
│  │  ├── src
│  │  ├── utest
│  │  └── CMakeLists.txt
│  ├── lib-gen
│  │  ├── include
│  │  ├── src
│  │  ├── utest
│  │  └── CMakeLists.txt
│  └── lib-codec
│     ├── include
│     ├── src
│     ├── utest
│     └── CMakeLists.txt
├── docs
│  ├── src
│  ├── site
│  └── docs.mak
├── tools
│  ├── cmake
│  ├── conan
│  ├── containers
│  ├── scripts
│  ├── static-analysis
│  └── submakes
└── etc
   ├── Contributing.md
   └── License</code></pre>
<p>Generally conforms to <a
href="https://github.com/vector-of-bool/pitchfork">PitchFork</a> project
layout.</p>
<h2 id="example-usages">Example Usages</h2>
<h3 id="simultaneous-production-and-debug-trees">Simultaneous Production
and Debug Trees</h3>
<p>Manage production and debug builds.</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span>             <span class="co"># build default tree (default is initially debug)</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span> prod        <span class="co"># build production tree, default is still debug</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span> debug       <span class="co"># build debug tree, default is still debug</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span> set-prod    <span class="co"># set production tree to be default - sticky setting</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span>             <span class="co"># build default tree (production tree is default)</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span> debug       <span class="co"># build debug tree, default is still prod</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span> prod        <span class="co"># build prod tree, default is still prod</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span> both        <span class="co"># build both prod and debug trees</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span> both <span class="at">-j</span>     <span class="co"># build both prod and debug trees in parallel</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span> set-debug   <span class="co"># set debug tree to be default - sticky setting</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span> clean       <span class="co"># deletes entire _build folder (removes debug and prod)</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span> clean-debug <span class="co"># removes the debug tree</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span> clean-prod  <span class="co"># removes the prod tree</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span> show-default-build <span class="co"># show the default build type</span></span></code></pre></div>
<h3 id="run-the-executables">Run the Executables</h3>
<p>Assuming you have the handy <a
href="#handy-aliases-for-build-container">aliases</a> defined, and you
are sitting in the top folder, then:</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">bd</span> bin/redflame    <span class="co"># run the app out of debug tree </span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="ex">bp</span> bin/redflame    <span class="co"># run the app out of production tree</span></span></code></pre></div>
<p>Alternatively you could exec into the build container.</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">podman</span> exec <span class="at">-it</span> <span class="at">-w</span> /work/cpp-bootstrap gcc14-tools bash</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="ex">root#./_build/debug/bin/redflame</span>    <span class="co"># run the debug app</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Or if you have the bbash alias defined</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="ex">bbash</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="ex">root#./_build/debug/bin/redflame</span>    <span class="co"># run the debug app</span></span></code></pre></div>
<h3 id="run-unit-tests">Run Unit Tests</h3>
<div class="sourceCode" id="cb6"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span> unit-test          <span class="co"># runs unit tests for default build </span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span> unit-test-debug    <span class="co"># runs unit tests for debug build </span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span> unit-test-prod     <span class="co"># runs unit tests for prod build </span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span> unit-test-both     <span class="co"># runs unit tests for prod and debug build </span></span></code></pre></div>
<p>Or directly run a unit test executable. Assuming you have the handy
<a href="#handy-aliases-for-build-container">aliases</a> defined, and
you are sitting in the top folder, then:</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">bd</span> bin/lib-codec-ut     <span class="co"># run unit tests for library debug tree</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="ex">bp</span> bin/lib-codec-ut     <span class="co"># run unit tests for library production tree</span></span></code></pre></div>
<h3 id="build-and-examine-the-documentation">Build and Examine the
Documentation</h3>
<div class="sourceCode" id="cb8"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span> docs</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="ex">firefox</span> _build/site/index.html</span></code></pre></div>
<p>See the same auto-generated documentation here on <a
href="https://kingsolomon1954.github.io/cpp-bootstrap">Github
Pages</a>.</p>
<h2 id="unit-testing">Unit Testing</h2>
<ul>
<li>Uses <a href="https://github.com/doctest/doctest">doctest</a></li>
<li>Unit tests are kept separate from source code, even though doctest
allows unit test in the source file itself</li>
<li>Unconditionally compiles unit tests along with each build</li>
</ul>
<h2 id="versioning">Versioning</h2>
<ul>
<li>Single version file in project root, supports repeatable builds</li>
<li>Semantic versioning</li>
</ul>
<div class="sourceCode" id="cb9"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> version</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="ex">1.0.0</span></span></code></pre></div>
<ul>
<li>All built artifacts obtain version information from this one
file</li>
<li>Auto-documentation and containers use this version file</li>
<li>CMake is configured to use this version file.</li>
<li>In addition, C++ Bootstrap supplies its own buildinfodefs.cmake to
auto generate additional build info. Versioning is then made available
to the application via the <a
href="https://kingsolomon1954.github.io/cpp-bootstrap/doxygen/html/classLibGen_1_1BuildInfo.html">BuildInfo
class</a> in lib-gen.</li>
</ul>
<div class="sourceCode" id="cb10"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> ./bin/redflame</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="ex">RedFlame</span> v1.0.0-1728572288</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Built</span> by: root</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Build</span> date: 2024-10-10T07:58:08-07:00</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Build</span> epoch: 1728572288</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Build</span> branch: ProjectRestructure</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Last</span> commit hash: 932a53f3827f1e1d</span></code></pre></div>
<h2 id="documentation-generation">Documentation Generation</h2>
<ul>
<li>There are pre-canned auto documentation samples for:
<ul>
<li>manpage</li>
<li>user guide</li>
<li>design doc</li>
<li>doxygen output</li>
<li>licenses</li>
</ul></li>
<li>Uses <a href="https://www.sphinx-doc.org/">Sphinx</a> with <a
href="https://sphinx-rtd-theme.readthedocs.io/en/stable/index.html">read-the-docs</a>
theme</li>
<li><a href="https://www.doxygen.nl/">Doxygen</a> for internal API</li>
<li><a href="https://plantuml.com/">PlantUML</a> to auto build
diagrams</li>
<li>Makefile auto-generates PlantUML files into PNG files</li>
<li>Create or modify PlantUML files in
<code>docs/src/images/src</code></li>
<li>Suffix for PlantUML files must be <code>.puml</code></li>
<li>Place or find auto created <code>.png</code>’s in
<code>docs/src/images/pub</code></li>
<li>Recommend creating diagrams with <a
href="https://www.drawio.com/">Drawio</a> and maintain drawio source
files in <code>docs/src/images/src</code></li>
<li>Export drawio diagram as a PNG into
<code>docs/src/images/pub</code></li>
</ul>
<h3 id="building-the-docs">Building the Docs</h3>
<p>From top level folder, invoke:</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span> docs</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="ex">firefox</span> _build/site/index.html</span></code></pre></div>
<h3 id="pubishing-the-docs">Pubishing the Docs</h3>
<p>When satisfied with the site docs, from top level folder, invoke the
following to publish the site.</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span> docs-publish</span></code></pre></div>
<p>The static website sitting in <code>_build/site</code>, is now copied
over to the <code>docs/site</code> folder and then checked into Git (not
pushed yet). When your branch is merged to main, a GitHub action kicks
in and publishes <code>docs/site</code> to GitHub Pages. You will need
to configure GitHub pages in your repository. To configure it, visit
your <GitHub
repo>/Settings-&gt;Pages-&gt;GitHub Pages.</p>
<p>The docs-publish rule looks something like this:</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> make <span class="ex">-n</span> docs-publish</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> rm <span class="at">-r</span> <span class="at">--ignore-unmatch</span> ./docs/site/<span class="pp">*</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> ./docs/site</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> <span class="at">-r</span> ./_build/site/<span class="pp">*</span> ./docs/site/</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">touch</span> ./docs/site/.nojekyll</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> add <span class="at">-A</span> ./docs/site</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> commit <span class="at">-m</span> <span class="st">&quot;Publish docs&quot;</span></span></code></pre></div>
<h3 id="spell-checking-docs">Spell Checking Docs</h3>
<ul>
<li>Spell checking can be performed against a given file or a tree of
files</li>
<li>Spell checking is invoked via Makefile target</li>
<li>Spell checking can be run in interactive or batch mode</li>
<li>Interactive mode lets you fix spelling in-place, file by file</li>
<li>Underlying (containerized) tool is <a
href="https://linux.die.net/man/1/hunspell">hunspell</a></li>
</ul>
<p>Makefile targets for spelling:</p>
<pre><code>spelling-clean    - Deletes spelling artifacts
spelling-help     - Displays help for spelling usage
spelling-it       - Spell checks all docs in interactive mode
spelling          - Spell checks all docs in batch mode
&lt;filepath&gt;.bspell - Spell checks given file in batch mode
&lt;filepath&gt;.ispell - Spell checks given file interactively</code></pre>
<p>For full details invoke:</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span> spelling-help</span></code></pre></div>
<h2 id="containerized-tools">Containerized Tools</h2>
<ul>
<li>Uses containers for build tools (compiler, auto-docs, etc)</li>
<li>Supports Docker or Podman, prefers Podman over Docker if found</li>
<li>Containers mount local host workspace, no copying into
container</li>
<li>GCC container is auto-started once and remains active</li>
<li>Re-compiles start immediately, no re-loading of GCC container</li>
<li>Same containers and tools on desktop and in CI pipelines</li>
<li>Convenient Makefile targets abstract away container commands</li>
<li>The Build container uses <a
href="https://hub.docker.com/_/gcc">docker.io/library/gcc</a> as its
base image which is a Debian distro, therefore executables you create
are for Debian Linux. If you want to build for a different distro then
you will want to <a href="#switching-build-container">switch</a> out the
Build container with your own.</li>
<li><a href="#container-registry-login">Automated login</a> to container
registries</li>
<li>Supports multiple container registries simultaneously</li>
</ul>
<p><strong>Why Containers</strong></p>
<ul>
<li><em>Avoids complex tool</em> management on host, avoids tool version
pollution</li>
<li><em>Consistent predictable</em> environment on both host and
pipeline/runner machines</li>
<li><em>Avoids dependency issues</em> and version conflicts on the host
and pipeline/runner machines</li>
<li><em>Reproducible builds</em> the set of containers used in a build
captures the entire environment as coherent tool set</li>
<li><em>Prevents conflicts</em> between host and runners that might use
different tools and/or libraries for other activities</li>
</ul>
<h3 id="handy-aliases-for-build-container">Handy Aliases for Build
Container</h3>
<p>Here’s several handy bash aliases that make working with the Build
Container easier. These are meant to be invoked while you’re sitting in
the top project folder on your host.</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="bu">alias</span> bd=<span class="st">&quot;podman exec -w /work/</span><span class="dt">\$</span><span class="st">(basename </span><span class="dt">\$</span><span class="st">(pwd))/_build/debug gcc14-tools&quot;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="bu">alias</span> bp=<span class="st">&quot;podman exec -w /work/</span><span class="dt">\$</span><span class="st">(basename </span><span class="dt">\$</span><span class="st">(pwd))/_build/prod gcc14-tools&quot;</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="bu">alias</span> bt=<span class="st">&quot;podman exec -w /work/</span><span class="dt">\$</span><span class="st">(basename </span><span class="dt">\$</span><span class="st">(pwd)) gcc14-tools&quot;</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="bu">alias</span> bbash=<span class="st">&#39;echo &#39;</span><span class="dt">\&#39;</span><span class="st">&#39;Use ctrl-p ctrl-q to quit&#39;</span><span class="dt">\&#39;</span><span class="st">&#39;; podman exec -it -w /work/$(basename $(pwd)) gcc14-tools bash&#39;</span></span></code></pre></div>
<p>Mnemonically they can be interpreted as:</p>
<ul>
<li><code>bd</code> - run a command in the container from
the_<strong>b</strong>uild/<strong>d</strong>ebug folder</li>
<li><code>bp</code> - run a command in the container from
the_<strong>b</strong>uild/<strong>p</strong>rod folder</li>
<li><code>bt</code> - run a command in the <strong>b</strong>uild
container from the <strong>t</strong>op folder</li>
<li><code>bbash</code> - <strong>bash</strong> into to the
<strong>b</strong>uild container at the shell prompt</li>
</ul>
<p>These aliases are also available in a script. You will want to change
the value of _CPP_BOOTSTRAP_HOME in there first to agree with your
environment.</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> admin/scripts/devenv.bash</span></code></pre></div>
<h3 id="container-registry-login">Container Registry Login</h3>
<p>Supports automated and manual login into container registries.</p>
<p>Each container image can come from a different registry. The registry
that C++ Bootstrap uses for a given container image is specified in the
<code>admin/submakes/container-names-&lt;tool&gt;.mak</code>. Each
containerized tool has its own container-names file.</p>
<p>Currently supports:</p>
<ul>
<li>localhost</li>
<li>docker.io</li>
<li>ghcr.io</li>
<li>artifactory.io</li>
</ul>
<p>Login credentials are read from the following locations on your host
in the order shown:</p>
<ol type="1">
<li>environment variables</li>
<li>from files</li>
<li>otherwise command line prompt</li>
</ol>
<p>Reads credentials (personal access token(PAT) or password and user
name) from these environment variables if found:</p>
<ul>
<li>reads env variable <code>&lt;REGISTRY&gt;_PAT</code> (“.” turned
into underscore)</li>
<li>reads env variable <code>&lt;REGISTRY&gt;_USERNAME</code></li>
</ul>
<p>For example, if the container registry is <code>docker.io</code> then
looks for these environment variables:</p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>  <span class="ex">DOCKER_IO_PAT</span>         <span class="co"># personal access token / password</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="ex">DOCKER_IO_USERNAME</span>    <span class="co"># login user name for this registry</span></span></code></pre></div>
<p>Reads credentials (personal access token(PAT) or password and user
name) from these files if found:</p>
<ul>
<li>reads access token file:
<code>$HOME/.ssh/&lt;REGISTRY&gt;-token</code></li>
<li>reads username file:
<code>$HOME/.ssh/&lt;REGISTRY&gt;-username</code></li>
</ul>
<p>For example, if container registry is <code>docker.io</code> then
looks for these files:</p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>  <span class="va">$HOME</span><span class="ex">/.ssh/docker.io-token</span>     <span class="co"># personal access token / password</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="va">$HOME</span><span class="ex">/.ssh/docker.io-username</span>  <span class="co"># login user name for this registry</span></span></code></pre></div>
<p>These files should have just a single line each. For example:</p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> cat <span class="va">$HOME</span><span class="ex">/.ssh/docker.io-token</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="ex">dhub_675b9Jam99721</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> cat <span class="va">$HOME</span><span class="ex">/.ssh/docker.io-username</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="ex">Elvis</span></span></code></pre></div>
<ul>
<li>if no env var or file, then prompts for PAT/password</li>
<li>if no env var or file, then prompts for username</li>
</ul>
<h2 id="conan-setup">Conan Setup</h2>
<ul>
<li>Setup as a consumer of Conan libraries, not a producer</li>
<li>Conan library cache is held on the build container, not the host
machine</li>
<li>Automated Conan registry login scheme, supports multiple
registries</li>
<li>Uses Conan lockfiles for locking down library versions for stable
repeatable builds</li>
<li>Makefile provides convenient commands to manipulate Conan on the
container</li>
</ul>
<h3 id="conan-auto-registry-setup">Conan Auto-Registry Setup</h3>
<p>Conan 2.0 supports multiple Conan registries. C++ Bootstrap comes
prepared with two Conan Registry files already filled out.</p>
<ul>
<li><code>admin/conan/registry-conancenter.properties</code></li>
<li><code>admin/conan/registry-aws-arty.properties</code></li>
</ul>
<p>The first one is a real registry. conancenter exists. The second one
is a made up registry for the purpose of demonstration.</p>
<p>C++ Bootstrap populates Conan registries into Conan just once, at
build initialization time, before any library retrieval is attempted.
And it re-populates these later if/when a new container is started, or
if a registry file changes.</p>
<p>To add or remove registries, just add or delete a file having the
following naming pattern:</p>
<pre><code>admin/conan/registry-*.properties</code></pre>
<p>Properties found in these files are then used to setup each registry
in Conan. The parsing is not sophisticated or flexible, uses simple
greps, so please adhere closely to the layout in the files.</p>
<p>A Conan registry file looks like this:</p>
<div class="sourceCode" id="cb22"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> cat <span class="ex">admin/conan/registry-aws-arty.properties</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="ex">name:</span> aws-arty</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="ex">url:</span> https://aws.artifactory.io</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="ex">login:</span> no</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="ex">enable:</span> yes</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="ex">publish:</span> yes</span></code></pre></div>
<p><strong>name:</strong> &lt;registry&gt; the name you give to this
Conan registry. Name is one word. No quotes around it. Must be separated
from the “:” with a space. Best to avoid dashes and periods in the name,
although these will be turned into an underscore for env-var names.</p>
<p><strong>url:</strong> &lt;url&gt; the registry server. url is one
word. No quotes around it. Must be separated from the “:” with a
space.</p>
<p><strong>login:</strong> [yes|no] whether to perform automated login.
See next section for more details. One word. No quotes around it. Must
be separated from the “:” with a space.</p>
<p><strong>enable:</strong> [yes|no] whether to use or hide this
registry. One word. No quotes around it. Must be separated from the “:”
with a space. This is builtin Conan feature, not a C++ Bootstrap
addition.</p>
<p><strong>publish:</strong> [yes|no] identify this registry as the one
registry to use for publishing your own Conan library packages. One
word. No quotes around it. Must be separated from the “:” with a space.
Only one registry can be be selected for publishing. If multiple
property files indicate “yes”, C++ Bootstrap will silently accept the
first one it finds. It is not an error if no registry is identified for
publishing as would be case if your project is a Conan consumer-only
project.</p>
<h3 id="conan-auto-login">Conan Auto-Login</h3>
<p>A registry can be configured in Conan with or without having Conan
establish a login to it. If your project is a Conan library consumer,
then generally you don’t need a login. conancenter works this way. But
some registries require a login even for consumer-only operations.</p>
<p>The two registry property files that come with C++ Bootstrap
currently specify <code>login: no</code>. If a registry requires a
login, change the login attribute to <code>login: yes</code>.</p>
<p>C++ Bootstrap supports automated as well as manual login.</p>
<p>For automation, login credentials are read from the following
locations in the given order, keying off of the name of the registry in
the property file (i.e., <code>name: &lt;registry&gt;</code>).</p>
<ol type="1">
<li>from environment variables</li>
<li>from files</li>
<li>from command line prompt</li>
</ol>
<h4 id="from-environment-variables">From Environment Variables</h4>
<p>Reads credentials (personal access token(PAT) or password and user
name) from these environment variables if found:</p>
<pre><code>&lt;REGISTRY&gt;_USERNAME
&lt;REGISTRY&gt;_PAT      (&quot;-&quot; turned into underscore)</code></pre>
<p>For example, if the Conan registry is <code>aws-arty</code> then
looks for these environment variables:</p>
<pre><code>AWS_ARTY_USERNAME    # login user name for this registry
AWS_ARTY_PAT         # personal access token / password</code></pre>
<h4 id="from-files">From Files</h4>
<p>Reads credentials (personal access token(PAT) or password and user
name) from files if found:</p>
<pre><code>~/.ssh/&lt;REGISTRY&gt;-username
~/.ssh/&lt;REGISTRY&gt;-token</code></pre>
<p>For example, if container registry is <code>aws-arty</code> then
looks for these files:</p>
<pre><code>$HOME/.ssh/aws-arty-username  # login user name for this registry
$HOME/.ssh/aws-arty-token     # personal access token / password</code></pre>
<p>These files have just a single line each. For example:</p>
<div class="sourceCode" id="cb27"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> cat <span class="va">$HOME</span><span class="ex">/.ssh/aws-arty-username</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ElvisTheDeveloper</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> cat <span class="va">$HOME</span><span class="ex">/.ssh/aws-arty-token</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="ex">aws_regy_675b9Jam99721</span></span></code></pre></div>
<h4 id="from-command-line-prompt">From Command Line Prompt</h4>
<p>if no env-var or file, then prompts for PAT/password<br> if no
env-var or file, then prompts for username</p>
<h3 id="conan-library-publishing">Conan Library Publishing</h3>
<p>TBS</p>
<h2 id="static-code-analysis">Static Code Analysis</h2>
<p>Static code analysis can be performed against all source code in the
repository or against a single file. Built-in support for error
suppression-list. Underlying tool is a containerized
<code>cppcheck</code>.</p>
<p>The following makefile targets are available:</p>
<pre><code>static-analysis       - Runs C++ static analysis against repo
static-analysis-clean - Deletes C++ static analysis artifacts
static-analysis-help  - Displays help for C++ static analysis
&lt;filepath&gt;.sta        - Runs C++ static analysis on given file</code></pre>
<p>Find results in
<code>_build/static-analysis/report/index.html</code>.</p>
<div class="sourceCode" id="cb29"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span> static-analysis</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="ex">firefox</span> _build/static-analysis/report/index.html</span></code></pre></div>
<p>The static analysis report is included and published as part of the
site documentation. A newer static analysis report replaces a previous
one provided the newer static analysis report is available at the time
<code>make docs</code> is invoked. If no static analysis report is
available at that time, then the last published static analysis report
remains.</p>
<h2 id="code-coverage">Code Coverage</h2>
<p>To get a code coverage report, invoke the following makefile
target.</p>
<div class="sourceCode" id="cb30"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span> code-coverage</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="ex">firefox</span> _build/debug/coverage/index.html</span></code></pre></div>
<p>This target rebuilds the debug tree with flags enabling coverage and
profiling, then invokes the CMake <code>coverage</code> target which
invokes unit tests along with <code>gcov</code>. Find the report in the
<code>_build/debug/coverage</code> folder.</p>
<p>Note that normal debug builds do not enable coverage / profiling
flags. These flags slow down compiles dramatically. Therefore this
separate makefile target is available for when you want focus on this
area.</p>
<p>The code coverage report is included and published as part of the
site documentation. A newer code coverage report replaces a previous one
provided the newer coverage report is available at the time
<code>make docs</code> is invoked. If no coverage report is available at
that time, then the last published code coverage report remains.</p>
<h2 id="getting-started">Getting Started</h2>
<h3 id="retrieve-c-starter-project">1. Retrieve C++ Starter Project</h3>
<p>Grab the repo as a <a
href="https://help.github.com/en/github/creating-cloning-and-archiving-repositories/creating-a-repository-from-a-template">template</a>.</p>
<h3 id="first-invocation">2. First invocation</h3>
<p>See if your host environment is suitable enough for
<code>make help</code>.</p>
<div class="sourceCode" id="cb31"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span> help</span></code></pre></div>
<h3 id="create-the-build-and-sphinx-container">3. Create the Build and
Sphinx Container</h3>
<p>Create your own local Build and Sphinx containers (for now).</p>
<p>See <a href="#switching-build-container">switching build
container</a> and <a href="#switching-sphinx-container">switching sphinx
container</a> below.</p>
<p>TODO: future - make containers available in DockerHub.</p>
<h3 id="compile-link-test-and-run">4. Compile, Link, Test and Run</h3>
<div class="sourceCode" id="cb32"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span> unit-test</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="ex">bd</span> bin/redflame</span></code></pre></div>
<h2 id="customize">5. Customize</h2>
<p>Customize the project to be your own.</p>
<h2 id="additional-activities">Additional Activities</h2>
<h3 id="switching-build-container">Switching Build Container</h3>
<p>Modify file <code>admin/submakes/container-names-gcc14.mak</code> as
follows:</p>
<p>Change:</p>
<pre><code>CNTR_GCC_14_TOOLS_REPO  := ghcr.io
CNTR_GCC_14_TOOLS_IMAGE := kingsolomon1954/containers/gcc14-tools</code></pre>
<p>To:</p>
<pre><code>CNTR_GCC_14_TOOLS_REPO  := localhost
CNTR_GCC_14_TOOLS_IMAGE := gcc14-tools</code></pre>
<p>Now build the container image:</p>
<div class="sourceCode" id="cb35"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span> cntr-build-gcc14-tools</span></code></pre></div>
<p>You should now have a container image in your local registry. Looks
something like this:</p>
<pre><code>REPOSITORY             TAG      IMAGE ID      CREATED        SIZE
localhost/gcc14-tools  latest   ec7fcbd0727b  2 months ago   1.78 GB</code></pre>
<h3 id="switching-sphinx-container">Switching Sphinx Container</h3>
<p>Modify file <code>admin/submakes/container-names-sphinx.mak</code> as
follows:</p>
<p>Change:</p>
<pre><code>CNTR_SPHINX_REPO  := ghcr.io
CNTR_SPHINX_IMAGE := kingsolomon1954/containers/sphinx</code></pre>
<p>To:</p>
<pre><code>CNTR_SPHINX_REPO  := localhost
CNTR_SPHINX_IMAGE := sphinx</code></pre>
<p>Now build the container image:</p>
<div class="sourceCode" id="cb39"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span> cntr-build-sphinx-tools</span></code></pre></div>
<p>You should now have a container image in your local registry. Looks
something like this:</p>
<pre><code>REPOSITORY             TAG      IMAGE ID      CREATED        SIZE
localhost/sphinx       7.3.7    cd0fbf8fe687  3 months ago   367 MB</code></pre>
<h3 id="compiling-a-single-file">Compiling a Single File</h3>
<p>Assuming you have the <a
href="#handy-aliases-for-build-container">aliases</a> defined above:</p>
<div class="sourceCode" id="cb41"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="ex">bd</span> make <span class="at">-C</span> main src/Properties.o</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="ex">bd</span> make <span class="at">-C</span> lib-codec src/CodecFast.o</span></code></pre></div>
<p>This invokes the CMake generated Makefile on the build container
specifying the file to compile. Note this works only after a build has
taken place and thus CMake is properly configured.</p>
<h3 id="compiling-a-specific-target">Compiling a Specific Target</h3>
<p>Often it is preferable and more efficient to compile only the target
under change as opposed to invoking the entire build.</p>
<p>Assuming you have the <a
href="#handy-aliases-for-build-container">aliases</a> defined above:</p>
<div class="sourceCode" id="cb42"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="ex">bd</span> make help        <span class="co"># See the CMake targets</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="ex">bd</span> make lib-gen     <span class="co"># Build just the lib-gen library target</span></span></code></pre></div>
</body>
</html>
